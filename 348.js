/*! For license information please see 348.js.LICENSE.txt */
(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[348],{9903:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var r=n(2784),o=n(8397),i=(n(9914),n(4355));function a(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function l(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var u=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];t.push(o)}return t},f=function(){this.parent=null,this.children={},this.end=!1,this.word=[[],0,0]},d=function(){function e(){this.root=new f}return e.prototype.insert=function(e,t,n){for(var r=this.root,o=u(e),i=0;i<o.length;i++)r.children[o[i]]||(r.children[o[i]]=new f,r.children[o[i]].parent=r,r.children[o[i]].word[0]=r.word[0].concat(o[i])),r=r.children[o[i]],i===o.length-1&&(r.end=!0,r.word[1]=t,r.word[2]=n)},e.prototype.commonPrefixSearch=function(e){for(var t=[],n=this.root.children[e[0]],r=0;r<e.length&&n;r++)n.end&&t.push(n.word),n=n.children[e[r+1]];return t.length||t.push([[e[0]],0,0]),t},e}(),h=function(){function e(e){this.vocabulary=e,this.trie=new d;for(var t=6;t<this.vocabulary.length;t++)this.trie.insert(this.vocabulary[t][0],this.vocabulary[t][1],t)}return e.prototype.encode=function(e){var t=[],n=[],r=[];e=function(e){return"▁"+e.normalize("NFKC").replace(/ /g,"▁")}(e);for(var o=u(e),i=0;i<=o.length;i++)t.push({}),n.push(0),r.push(0);for(i=0;i<o.length;i++)for(var a=this.trie.commonPrefixSearch(o.slice(i)),s=0;s<a.length;s++){var l=a[s],c={key:l[0],score:l[1],index:l[2]};null==t[i+(f=l[0].length)][i]&&(t[i+f][i]=[]),t[i+f][i].push(c)}for(var f=0;f<=o.length;f++)for(var d in t[f]){var h=t[f][d];for(s=0;s<h.length;s++){var p=h[s],m=p.score+r[f-p.key.length];(0===r[f]||m>=r[f])&&(r[f]=m,n[f]=h[s].index)}}for(var b=[],v=n.length-1;v>0;)b.push(n[v]),v-=this.vocabulary[n[v]][0].length;var y=[],g=!1;for(i=0;i<b.length;i++){var x=b[i];g&&0===x||y.push(x),g=0===x}return y.reverse()},e}();function p(e){return l(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return[4,m(e)];case 1:return t=n.sent(),[2,new h(t)]}}))}))}function m(e){return void 0===e&&(e="https://storage.googleapis.com/tfjs-models/savedmodel/universal_sentence_encoder/vocab.json"),l(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,o.util.fetch(e)];case 1:return[2,t.sent().json()]}}))}))}var b=function(){function e(e,t){void 0===e&&(e=.85),void 0===t&&(t=[]),this.threshold=e,this.toxicityLabels=t}return e.prototype.loadModel=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,(0,i.loadGraphModel)("https://tfhub.dev/tensorflow/tfjs-model/toxicity/1/default/1",{fromTFHub:!0})]}))}))},e.prototype.loadTokenizer=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,p()]}))}))},e.prototype.load=function(){return a(this,void 0,void 0,(function(){var e,t,n,r=this;return s(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this.loadModel(),this.loadTokenizer()])];case 1:return e=i.sent(),t=e[0],n=e[1],this.model=t,this.tokenizer=n,this.labels=t.outputs.map((function(e){return e.name.split("/")[0]})),0===this.toxicityLabels.length?this.toxicityLabels=this.labels:o.util.assert(this.toxicityLabels.every((function(e){return r.labels.indexOf(e)>-1})),(function(){return"toxicityLabels argument must contain only items from the model heads "+r.labels.join(", ")+", got "+r.toxicityLabels.join(", ")})),[2]}}))}))},e.prototype.classify=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,a,l,c,u=this;return s(this,(function(s){switch(s.label){case 0:for("string"==typeof e&&(e=[e]),t=e.map((function(e){return u.tokenizer.encode(e)})),n=t.map((function(e,t){return e.map((function(e,n){return[t,n]}))})),r=[],i=0;i<n.length;i++)r=r.concat(n[i]);return a=(0,o.tensor2d)(r,[r.length,2],"int32"),l=(0,o.tensor1d)(o.util.flatten(t),"int32"),[4,this.model.executeAsync({Placeholder_1:a,Placeholder:l})];case 1:return c=s.sent(),a.dispose(),l.dispose(),[2,c.map((function(e,t){return{data:e,headIndex:t}})).filter((function(e){return u.toxicityLabels.indexOf(u.labels[e.headIndex])>-1})).map((function(t){for(var n=t.data.dataSync(),r=[],o=0;o<e.length;o++){var i=n.slice(2*o,2*o+2),a=null;Math.max(i[0],i[1])>u.threshold&&(a=i[0]<i[1]),r.push({probabilities:i,match:a})}return{label:u.labels[t.headIndex],results:r}}))]}}))}))},e}(),v=n(2779),y=n.n(v),g=n(2776);const x=[{id:"002261b0415c4f9d",text:"We're dudes on computers, moron.  You are quite astonishingly stupid."},{id:"0027160ca62626bc",text:"Please stop. If you continue to vandalize Wikipedia, as you did to Kmart, you will be blocked from editing."},{id:"002fb627b19c4c0b",text:"I respect your point of view, and when this discussion originated on 8th April I would have tended to agree with you."}];function w(){const e=(0,r.useRef)(null),[t,n]=(0,r.useState)(),[o,i]=(0,r.useState)([]);(0,r.useEffect)((()=>{(async()=>{n(await function(e,t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,(e=new b(undefined,undefined)).load()];case 1:return t.sent(),[2,e]}}))}))}())})()}),[]);const l=(0,r.useMemo)((()=>t&&t.model.outputNodes.map((e=>e.split("/")[0]))),[t]),c=(0,r.useCallback)((async e=>{const n=await t.classify(e);return e.map(((e,t)=>({text:e,match:n.reduce(((e,{label:n,results:r})=>Object.assign(e,{[n]:r[t].match})),{})})))}),[t]),u=(0,r.useCallback)((async e=>{const t=await c(e);console.log({predictions:t}),i((e=>e.concat(t)))}),[t]);return(0,r.useEffect)((()=>{t&&u(x.map((e=>e.text)))}),[t]),r.createElement("section",{className:g.Z.Section},r.createElement("h2",null,"Toxicity"),r.createElement("div",{className:g.Z.Container},r.createElement("h3",null,"TensorFlow.js toxicity classifier demo"),r.createElement("div",{className:g.Z.Description},"This is a demo of the TensorFlow.js toxicity model, which classifies text according to whether it exhibits offensive attributes (i.e. profanity, sexual explicitness). The samples in the table below were taken from this"," ",r.createElement("a",{href:"https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge/data"},"Kaggle dataset"),"."),l&&r.createElement("div",{id:"table-wrapper",className:g.Z.TableWrapper},r.createElement("div",{className:g.Z.Row},r.createElement("div",{className:g.Z.Text},"TEXT"),l.map(((e,t)=>r.createElement("div",{key:t,className:g.Z.Label},e.replace("_"," "))))),o.map(((e,t)=>r.createElement("div",{key:t,className:g.Z.Row},r.createElement("div",{className:g.Z.Text},e.text),l.map(((t,n)=>r.createElement("div",{key:n,className:y()(g.Z.Label,e.match[t]&&g.Z.positive)},e.match[t]?"true":"false"))))))),r.createElement("p",null,"Enter text below and click 'Classify' to add it to the table."),r.createElement("form",{id:"classify-new",onSubmit:t=>(t.preventDefault(),u([e.current.value]))},r.createElement("input",{className:g.Z.ClassifyInput,ref:e,id:"classify-new-text-input",placeholder:"i.e. 'you suck'",required:!0}),r.createElement("button",{className:g.Z.ClassifyButton,id:"classify-new-text",type:"submit"},"Classify"))))}},2779:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var a=o.apply(null,n);a&&e.push(a)}}else if("object"===i)if(n.toString===Object.prototype.toString)for(var s in n)r.call(n,s)&&n[s]&&e.push(s);else e.push(n.toString())}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},8342:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var r=n(9601),o=n.n(r),i=n(2609),a=n.n(i)()(o());a.push([e.id,'.H_3Y91W6LOfvrGM1yd_d{color:green}.aFgjo4K2HsfDLk1AH5YL{position:relative;font-family:"Helvetica Neue",sans-serif;box-sizing:border-box;line-height:1.5}.aFgjo4K2HsfDLk1AH5YL h1{margin-bottom:30px;font-size:34px}.aFgjo4K2HsfDLk1AH5YL .JwnXsVDyEIPBNPYGKJYR{margin-bottom:60px}.aFgjo4K2HsfDLk1AH5YL .Sk9ADJZKTImxNTMUVsfE{display:flex;flex-direction:row}.aFgjo4K2HsfDLk1AH5YL .Sk9ADJZKTImxNTMUVsfE:nth-of-type(2n){background:#f5f5f5}.aFgjo4K2HsfDLk1AH5YL .Sk9ADJZKTImxNTMUVsfE .qmesx3c32ZfThTW0n2UX{flex:1 1 auto}.aFgjo4K2HsfDLk1AH5YL .Sk9ADJZKTImxNTMUVsfE .rOGkIH5JOUw4NbnB39AD{border-left:solid 1px #ccc;width:60px;min-width:60px;max-width:60px}.aFgjo4K2HsfDLk1AH5YL .Sk9ADJZKTImxNTMUVsfE .rOGkIH5JOUw4NbnB39AD.FsT45MnMvtCL_QHdbgHO{font-weight:bold;color:red}.aFgjo4K2HsfDLk1AH5YL .Sk9ADJZKTImxNTMUVsfE:first-of-type .rOGkIH5JOUw4NbnB39AD{border:none}.aFgjo4K2HsfDLk1AH5YL .Sk9ADJZKTImxNTMUVsfE:first-of-type .rOGkIH5JOUw4NbnB39AD,.aFgjo4K2HsfDLk1AH5YL .Sk9ADJZKTImxNTMUVsfE:first-of-type .qmesx3c32ZfThTW0n2UX{font-weight:bold;text-transform:lowercase;line-height:1.4;padding-bottom:20px}.aFgjo4K2HsfDLk1AH5YL .qmesx3c32ZfThTW0n2UX,.aFgjo4K2HsfDLk1AH5YL .rOGkIH5JOUw4NbnB39AD{padding:10px}.aFgjo4K2HsfDLk1AH5YL .PsumhLeZ8w0QBRfCImBc{border:none;border-bottom:solid 1px #ccc;cursor:pointer;font-size:14px;line-height:2;width:calc(100% - 127px);margin-right:15px;padding-left:5px;padding-right:5px;padding-top:4px;padding-bottom:4px}.aFgjo4K2HsfDLk1AH5YL .iW4rwrHc2gx761eQpBOy{border:none;text-transform:uppercase;padding:9px 14px 9px 14px;font-size:13px;border-radius:3px;letter-spacing:1px;background:#0277bd;color:#fff}.aFgjo4K2HsfDLk1AH5YL .iW4rwrHc2gx761eQpBOy,.aFgjo4K2HsfDLk1AH5YL .PsumhLeZ8w0QBRfCImBc{display:inline-block;vertical-align:top}.aFgjo4K2HsfDLk1AH5YL .QshVaaS6_4qDBgUBAIdF{margin-bottom:60px}.aFgjo4K2HsfDLk1AH5YL p{font-weight:bold}',""]),a.locals={Section:"H_3Y91W6LOfvrGM1yd_d",Container:"aFgjo4K2HsfDLk1AH5YL",Description:"JwnXsVDyEIPBNPYGKJYR",Row:"Sk9ADJZKTImxNTMUVsfE",Text:"qmesx3c32ZfThTW0n2UX",Label:"rOGkIH5JOUw4NbnB39AD",positive:"FsT45MnMvtCL_QHdbgHO",ClassifyInput:"PsumhLeZ8w0QBRfCImBc",ClassifyButton:"iW4rwrHc2gx761eQpBOy",TableWrapper:"QshVaaS6_4qDBgUBAIdF"};const s=a},2776:(e,t,n)=>{"use strict";n.d(t,{Z:()=>x});var r=n(6062),o=n.n(r),i=n(4036),a=n.n(i),s=n(6793),l=n.n(s),c=n(7892),u=n.n(c),f=n(1173),d=n.n(f),h=n(2464),p=n.n(h),m=n(8342),b={};b.styleTagTransform=p(),b.setAttributes=u(),b.insert=l().bind(null,"head"),b.domAPI=a(),b.insertStyleElement=d();var v=o()(m.default,b);if(!m.default.locals||e.hot.invalidate){var y=!m.default.locals,g=y?m:m.default.locals;e.hot.accept(8342,(t=>{m=n(8342),function(e,t,n){if(!e&&t||e&&!t)return!1;var r;for(r in e)if((!n||"default"!==r)&&e[r]!==t[r])return!1;for(r in t)if(!(n&&"default"===r||e[r]))return!1;return!0}(g,y?m:m.default.locals,y)?(g=y?m:m.default.locals,v(m.default)):e.hot.invalidate()}))}e.hot.dispose((function(){v()}));const x=m.default&&m.default.locals?m.default.locals:void 0},327:()=>{},6843:()=>{},660:()=>{}}]);